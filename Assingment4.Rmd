---
title: "206 Assignment 4"
author: "Sidney Gerst"
date: "November 13, 2018"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load Packages and read in files

```{r, echo=FALSE, message=FALSE}
library(tidyverse)
library(pwr)
library(knitr)
library(kableExtra)
library(plotly)
library(ggrepel)
library(effsize)
library(vcdExtra)
library(dplyr)

lobster_pressure <- read_csv("lobster_traps.csv")

lobster_size <- read_csv("lobster_size_abundance.csv")



```

Clean up Data before converting to tidy

```{r, echo=FALSE, message=FALSE}
size_clean <- lobster_size %>%
  select(YEAR, SITE, SIZE, COUNT) %>%
  filter(COUNT != "0")

size_clean

pressure_clean <- lobster_pressure %>%
  select(YEAR, SITE, TRAPS) 
  
pressure_clean



```


Part 1: Lobster abundance and fishing pressure
- Exploratory data analysis
    - Data frame and scatter plots with 5 locations with counts and fishing pressure (traps) for 2012-2017 (separately)
    - Finalized data summary table for counts/traps at each of the locations by year *** Need to do this
    - Finalized Histogram for each location with count/fishing pressure *** Need to do this
    - Finalized QQ-Plots for each location  *** Need to do this
    - Finalized line graphs for abundance and pressure 
    
    
```{r, echo=FALSE, message=FALSE}

# Make scatter plot for MEAN annual abundance by site (2012-2017)
abundance <- size_clean %>% 
  select(YEAR, SITE, COUNT) %>% 
  group_by(SITE, YEAR) %>% 
  summarize (
      total_count = round(sum(COUNT), digits = 1)
    ) %>% 
  ggplot(aes(x=YEAR, y = total_count))+
  geom_point() +
  facet_wrap(~SITE, scale = "free") +
  xlab("Year") +
  ylab("Mean Count")+
  theme_classic()
  

abundance


# Make column graph of total abundance by site (2012-2017)
abundance_col <- ggplot(size_clean, aes(x = YEAR, y = COUNT))+
  geom_col()+
  facet_wrap(~SITE, scale = "free")+
  theme_classic()

abundance_col


# Make line graph of total abundance within each site (2012-2017)
abundance_line <- as.data.frame(size_clean) %>% 
  expand.dft(freq="COUNT") %>% 
  count(YEAR, SITE) %>% 
  ggplot(aes(x=YEAR, y = n))+
  geom_line(aes(color=SITE)) +
  xlab("Year") +
  ylab("Total Count")+
  ggtitle("Lobster Abundance at LTER Sites in the Santa Barbara Channel")+
  theme_classic()

abundance_line

# Make finalized data summary table for lobseter abundance (2012-2017) 



```



```{r, echo=FALSE, message=FALSE}

# Make a scatter plot for MEAN annual lobster pressure for each site (2012-2017)
pressure <- pressure_clean %>% 
  select(YEAR, SITE, TRAPS) %>%
  filter(SITE == "AQUE"| SITE == "NAPL" | SITE == "MOHK"| SITE == "IVEE"| SITE == "CARP") %>% 
  group_by(SITE, YEAR) %>% 
  summarize (
      total_traps = round(sum(TRAPS), digits = 1)
    ) %>% 
  ggplot(aes(x=YEAR, y = total_traps))+
  geom_point() +
  facet_wrap(~SITE, scale = "free") +
  xlab("Year") +
  ylab("Mean Pressure")+
  ggtitle("Lobster Abundance between 2012 and 2017")+
  theme_classic()

pressure
 

# Make a column graph for total pressure for each site (2012-2017)
pressure_col <- ggplot(pressure_clean, aes(x = YEAR, y = TRAPS))+
  geom_col()+
  facet_wrap(~SITE, scale = "free")

pressure_col


# Make line graph of total pressure within each site (2012-2017)
pressure_line <- as.data.frame(pressure_clean) %>% 
  expand.dft(freq="TRAPS") %>% 
  count(YEAR, SITE) %>% 
  ggplot(aes(x=YEAR, y = n))+
  geom_line(aes(color=SITE)) +
  xlab("Year") +
  ylab("Total Pressure")+
  ggtitle("Lobster Pressure at LTER Sites in Santa Barbara Channel")+
  theme_classic()

pressure_line


# Make a finalized data summary table for lobster pressure by site (2012-2017)


```




Part 2. Compare mean lobster size by site in 2017

- Convert to tidy format
- Exploratory data analysis 
```{r}

# Convert abundance and pressure data frames into tidy format

abundance_tidy <- as.data.frame(size_clean) %>% 
  expand.dft(freq="COUNT")

pressure_tidy <- as.data.frame(pressure_clean) %>% 
  expand.dft(freq="TRAPS") 

```



